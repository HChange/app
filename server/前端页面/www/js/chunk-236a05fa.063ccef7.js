(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-236a05fa"],{"0fc3":function(t,e,s){"use strict";var a=s("b505");t.exports=function(t,e){var s=[][t];return!s||!a((function(){s.call(null,e||function(){throw 1},1)}))}},"4e0e":function(t,e,s){"use strict";var a=s("0e84"),o=s("d5b6");a({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},"57f9":function(t,e,s){},64791:function(t,e,s){var a=s("5bf1"),o=s("81a8"),r=s("d5b6"),i=s("fe5a");for(var n in o){var c=a[n],l=c&&c.prototype;if(l&&l.forEach!==r)try{i(l,"forEach",r)}catch(d){l.forEach=r}}},"81a8":function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},"92e5":function(t,e,s){var a=s("12fd"),o=s("57e5"),r=s("0d15"),i=s("f422"),n=s("f2a8"),c=[].push,l=function(t){var e=1==t,s=2==t,l=3==t,d=4==t,u=6==t,f=5==t||u;return function(v,h,p,g){for(var m,L,x=r(v),S=o(x),b=a(h,p,3),w=i(S.length),y=0,C=g||n,T=e?C(v,w):s?C(v,0):void 0;w>y;y++)if((f||y in S)&&(m=S[y],L=b(m,y,x),t))if(e)T[y]=L;else if(L)switch(t){case 3:return!0;case 5:return m;case 6:return y;case 2:c.call(T,m)}else if(d)return!1;return u?-1:l||d?d:T}};t.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6)}},d286:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"issue"}},[s("div",{staticStyle:{display:"none"},attrs:{id:"allmap"}}),s("app-header",{attrs:{hasBack:!0,title:"发布"}},[s("span",{staticClass:"right-btn",attrs:{slot:"right-btn"},on:{click:t.uploaderAction},slot:"right-btn"},[t._v("上传")])]),s("div",{staticClass:"content noBar"},[s("van-uploader",{staticClass:"uploader",attrs:{multiple:"","max-count":4},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}}),s("div",{staticClass:"desc border-bottom"},[s("div",{staticClass:"desc-title"},[s("h3",[t._v("描述")]),s("p",[t._v(t._s(t.words.length)+"/1000")])]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.words,expression:"words"}],ref:"desc",attrs:{placeholder:"填写描述和主题，可以让更多的人看到你的作品"},domProps:{value:t.words},on:{input:function(e){e.target.composing||(t.words=e.target.value)}}})]),s("div",{staticClass:"theme border-bottom"},[s("h3",[t._v("主题")]),s("van-dropdown-menu",{staticStyle:{height:"18px"}},[s("van-dropdown-item",{staticStyle:{"font-size":"13px"},attrs:{options:t.option1},model:{value:t.value1,callback:function(e){t.value1=e},expression:"value1"}})],1)],1),s("div",{staticClass:"address border-bottom"},[s("h3",[t._v("位置")]),t.address?t._e():s("a",{attrs:{href:"#"},on:{click:t.geoAction}},[t._v("点击获得作品位置")]),t.address?s("a",[t._v(t._s(t.address))]):t._e()]),s("div",{staticClass:"pro"},[s("van-switch-cell",{staticClass:"border-bottom",attrs:{title:"原创"},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1),t._m(0)],1)],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"footerEnd"},[s("p",[t._v("-The end-")])])}],r=(s("4e0e"),s("64791"),s("4360")),i=s("2427"),n=s.n(i),c={beforeRouteEnter:function(t,e,s){r["a"].state.isLogin?s():s("/login")},data:function(){return{fileList:[],words:"",value1:0,option1:[{text:"摄影师日常",value:0},{text:"分享一个好天气",value:1},{text:"假日旅行计划",value:2},{text:"趣味图片",value:3},{text:"吃货的世界",value:4},{text:"电影看这里",value:5},{text:"我爱这世界",value:6},{text:"拒绝平庸",value:7},{text:"美妆你懂吗",value:8},{text:"无尽天光与你",value:9},{text:"其他",value:10}],checked:!0,address:"",url:""}},methods:{uploaderAction:function(){var t=this;if(0==this.fileList.length)this.$Toast("请添加至少一张图片");else if(""==this.$refs.desc.value||""==this.address)this.$Toast("请将信息填写完整");else{this.$Toast.loading("正在发布...");var e=new FormData,s=[];this.fileList.forEach((function(a){e.append("img",a.file),s.push(t.fileList.value)}));document.querySelector(".van-uploader__input").value;e.append("desc",this.$refs.desc.value),e.append("address",this.address),e.append("theme",this.option1[this.value1].text),e.append("pro",this.checked);var a=this,o={headers:{"Content-Type":"multipart/form-data"}};n.a.post("http://localhost:4000/upload/img",e,o).then((function(t){var e;e=storage.get("soso")?storage.get("soso").length:0;var s={id:e,username:r["a"].state.userInfo.username,img:t.data,desc:a.$refs.desc.value,address:a.address,pro:a.option1[a.value1].text,checked:a.checked};storage.get("soso")||storage.set("soso",[]);var o=storage.get("soso");o.push(s),storage.set("soso",o),a.$router.push("/topic/today"),a.$Toast.clear()})).catch((function(t){console.log(t)}))}},geoAction:function(){this.$Toast.loading({message:"位置获取中...",forbidClick:!0,duration:0});var t=this,e=new BMap.Geolocation;e.getCurrentPosition((function(e){if(this.getStatus()==BMAP_STATUS_SUCCESS){new BMap.Marker(e.point);t.getAddress(e.point)}else alert("failed"+this.getStatus())}))},getAddress:function(t){var e=this,s=new BMap.Geocoder;s.getLocation(t,(function(t){var s=t.addressComponents,a=s.province+s.city+s.district+s.street+s.streetNumber;e.address=a,e.$Toast.clear()}))}},watch:{words:function(){this.words.length>=1e3&&(this.words=this.words.substr(0,1e3))}}},l=c,d=(s("ed52"),s("4e82")),u=Object(d["a"])(l,a,o,!1,null,"c0e6666a",null);e["default"]=u.exports},d5b6:function(t,e,s){"use strict";var a=s("92e5").forEach,o=s("0fc3");t.exports=o("forEach")?function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}:[].forEach},ed52:function(t,e,s){"use strict";var a=s("57f9"),o=s.n(a);o.a},f2a8:function(t,e,s){var a=s("dc17"),o=s("fdac"),r=s("d86a"),i=r("species");t.exports=function(t,e){var s;return o(t)&&(s=t.constructor,"function"!=typeof s||s!==Array&&!o(s.prototype)?a(s)&&(s=s[i],null===s&&(s=void 0)):s=void 0),new(void 0===s?Array:s)(0===e?0:e)}},fdac:function(t,e,s){var a=s("4cbe");t.exports=Array.isArray||function(t){return"Array"==a(t)}}}]);
//# sourceMappingURL=chunk-236a05fa.063ccef7.js.map